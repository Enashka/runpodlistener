# ComfyUI Image Sync Tool

A simple tool to automatically sync images generated by ComfyUI on RunPod to Google Drive.

## Features

- Monitors the ComfyUI output directory for new images
- Automatically uploads new images to a specified Google Drive folder
- Runs in the background as a service
- Simple installation and setup

## Installation on RunPod

### Prerequisites

1. A Google Cloud project with the Google Drive API enabled
2. OAuth 2.0 credentials (credentials.json) for the Google Drive API
3. A Google Drive folder ID where images will be uploaded

### Installation Steps

1. Connect to your RunPod instance via SSH or the web terminal

2. Create a directory for the sync tool:
   ```bash
   mkdir -p /workspace/runpodlistener
   cd /workspace/runpodlistener
   ```

3. Download the sync script:
   ```bash
   curl -O https://raw.githubusercontent.com/Enashka/runpodlistener/main/minimal_sync.py
   chmod +x minimal_sync.py
   ```

4. Install dependencies:
   ```bash
   pip install pydrive2
   ```

5. Upload your credentials.json file to this directory (you can use the RunPod file browser)

6. Run the script once to authenticate:
   ```bash
   python minimal_sync.py YOUR_FOLDER_ID --once
   ```
   
   Follow the authentication link provided, sign in with your Google account, and paste the verification code back into the terminal.

7. Create a start script:
   ```bash
   curl -O https://raw.githubusercontent.com/Enashka/runpodlistener/main/start.sh
   chmod +x start.sh
   ```

8. Edit the start.sh script to include your Google Drive folder ID:
   ```bash
   sed -i 's/YOUR_FOLDER_ID/your_actual_folder_id/' start.sh
   ```

9. Start the sync service:
   ```bash
   ./start.sh
   ```

## Usage

The sync tool will run in the background and automatically upload new images from the ComfyUI output directory to your specified Google Drive folder.

To check the logs:
```bash
tail -f sync.log
```

To stop the service:
```bash
pkill -f minimal_sync.py
```

## Getting Your Google Drive Folder ID

1. Navigate to the folder in Google Drive where you want to upload images
2. The folder ID is the last part of the URL:
   ```
   https://drive.google.com/drive/folders/YOUR_FOLDER_ID
   ```

## Getting Google Drive API Credentials

1. Go to the [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select an existing one
3. Enable the Google Drive API
4. Create OAuth 2.0 credentials (Desktop application)
5. Download the credentials.json file

## License

[MIT License](LICENSE)
